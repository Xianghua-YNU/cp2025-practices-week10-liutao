# 数值积分方法比较实验报告（Simpson 法则 vs 梯形法则）

## 一、实验目的

1. 理解并掌握 Simpson 法则与梯形法则的数值积分原理及实现方法。
2. 通过实验比较两种方法在积分精度和误差方面的表现。
3. 能够分析不同子区间数 $N$ 对积分结果的影响。

---

## 二、实验原理

### 2.1 Simpson 法则

简述 Simpson 法则的积分思想、公式推导及适用条件（$N$ 必须为偶数），并给出公式：
$$
\int_a^b f(x)dx \approx \frac{h}{3}\left[f(x_0) + 4\sum_{i=1,3,5,...}^{N-1}f(x_i) + 2\sum_{i=2,4,6,...}^{N-2}f(x_i) + f(x_N)\right]
$$

### 2.2 梯形法则

简述梯形法则的积分思想、公式推导，并给出公式：
$$
\int_a^b f(x)dx \approx h\left[\frac{f(x_0)}{2} + f(x_1) + \cdots + f(x_{N-1}) + \frac{f(x_N)}{2}\right]
$$

---

## 三、实验代码

请粘贴你的完整 Python 实现代码（包括 Simpson 法则和梯形法则）：

```python
// ... 请粘贴 simpson_integration.py 的全部代码 ...
```
### 4.1 运行结果
请填写运行结果（或截图），包括 $N=100$ 和 $N=1000$ 时两种方法的积分值和相对误差。例如：

| N    | 梯形法则结果 | 梯形法则相对误差 | Simpson法则结果 | Simpson法则相对误差 |
|------|--------------|------------------|-----------------|--------------------|
| 100  |              |                  |                 |                    |
| 1000 |              |                  |                 |                    |
![QQ_1745982122514](https://github.com/user-attachments/assets/d3abbe9b-b9b0-4b65-b37b-0a1d47bc8007)


（可直接复制终端输出或截图）

### 4.2 误差分析
- 分析两种方法在不同 $N$ 下的误差表现。
  1. 两种方法在不同 N 下的误差表现在 solution.py 代码中，已经对梯形法则和 Simpson 法则在 \(N = 100\) 和 \(N = 1000\) 时的积分结果及相对误差进行了计算和输出。通过这些结果，我们可以直观地看到两种方法在不同 N 下的误差表现。一般来说，随着 N 的增大，两种方法的误差都会减小，因为 N 越大，积分区间被划分得越细，数值积分的结果就越接近真实值。
- Simpson 法则与梯形法则误差的数量级差异及原因。
  数量级差异：通常情况下，Simpson 法则的误差数量级会比梯形法则小。以代码中的计算结果为例，当 N 相同时，Simpson 法则的相对误差会明显小于梯形法则的相对误差。原因：梯形法则：梯形法则是用梯形的面积来近似代替曲线下的面积。它假设在每个小区间上，函数是线性变化的。然而，实际的函数可能是非线性的，这种线性近似会引入一定的误差。误差的阶数为 \(O(h^2)\)，其中 \(h=(b - a)/N\) 是每个小区间的宽度。Simpson 法则：Simpson 法则是用二次抛物线来近似代替曲线。它在每个小区间上使用二次函数进行拟合，因此能够更好地逼近非线性函数。误差的阶数为 \(O(h^4)\)，比梯形法则的误差阶数更高，所以在相同的 N 下，Simpson 法则的误差更小。
- 讨论 $N$ 增大时误差的变化趋势。
  梯形法则：由于梯形法则的误差阶数为 \(O(h^2)\)，当 N 增大时，\(h=(b - a)/N\) 会减小，误差会以 \(h^2\) 的速度减小。也就是说，当 N 变为原来的 k 倍时，误差会变为原来的 \(1/k^2\) 倍。Simpson 法则：Simpson 法则的误差阶数为 \(O(h^4)\)，当 N 增大时，误差会以 \(h^4\) 的速度减小。当 N 变为原来的 k 倍时，误差会变为原来的 \(1/k^4\) 倍。因此，随着 N 的增大，Simpson 法则的误差减小得更快。

## 五、结论
- 总结两种方法的适用场景和优劣。
  梯形法则：优点：实现简单，计算速度快。对于一些简单的函数或者对精度要求不高的情况，梯形法则是一个不错的选择。缺点：误差较大，尤其是对于非线性函数，其近似效果较差。适用场景：适用于对计算速度要求较高，而对精度要求相对较低的场景，例如在实时计算或者对大规模数据进行初步处理时。Simpson 法则：优点：精度高，能够更好地逼近非线性函数。误差的数量级比梯形法则小，在相同的 N 下，能够得到更准确的积分结果。缺点：要求 N 必须为偶数，计算复杂度相对较高。适用场景：适用于对精度要求较高的场景，例如科学计算、工程设计等领域。
- 结合本实验结果，说明实际工程中如何选择数值积分方法。
  精度要求：如果对积分结果的精度要求较高，例如在物理模拟、金融计算等领域，应该优先选择 Simpson 法则。如果对精度要求不高，例如在一些实时监测系统中，梯形法则可能就足够了。
计算复杂度：如果计算资源有限或者需要快速得到结果，梯形法则由于其简单的实现和较低的计算复杂度，可能是更好的选择。而 Simpson 法则虽然精度高，但计算复杂度相对较高，需要更多的计算资源和时间。
函数特性：如果被积函数是线性的或者接近线性的，梯形法则和 Simpson 法则的效果可能相差不大，此时可以选择计算更简单的梯形法则。如果被积函数是非线性的，尤其是具有较高的曲率，Simpson 法则能够提供更准确的结果。
